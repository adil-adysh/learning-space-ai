import{d as V,f as y,g as ue,a as f,e as U}from"../chunks/C-f-YIMz.js";import{K as _e,f as we,aZ as je,h as $,ar as ye,ac as be,at as le,W as ne,V as de,N as ge,t as Pe,i as Ce,a_ as ke,a$ as Ee,b0 as xe,G as X,aC as Fe,b as Se,Y as Le,b1 as Ie,j as r,k as L,aB as E,w as J,a2 as K,a8 as v,a6 as n,b2 as ve,a7 as d,a4 as N,aY as se,a5 as H,u as B,a3 as Z,_ as qe,X as Me,b3 as Ae}from"../chunks/D99GLro2.js";import{s as W}from"../chunks/BN-tp6At.js";import{i as O,b as ie}from"../chunks/DR9Kj4yn.js";import{r as me,a as R,s as ee,e as pe}from"../chunks/DEWr2Iab.js";import{c as De}from"../chunks/45jJ2bl6.js";function Te(i,e){let t=null,a=$;var s;if($){t=ge;for(var l=ye(document.head);l!==null&&(l.nodeType!==be||l.data!==i);)l=le(l);if(l===null)ne(!1);else{var P=le(l);l.remove(),de(P)}}$||(s=document.head.appendChild(_e()));try{we(()=>e(s),je)}finally{a&&(ne(!0),de(t))}}function fe(i,e,t=!1){if(i.multiple){if(e==null)return;if(!Ce(e))return ke();for(var a of i.options)a.selected=e.includes(ce(a));return}for(a of i.options){var s=ce(a);if(Ee(s,e)){a.selected=!0;return}}(!t||e!==void 0)&&(i.selectedIndex=-1)}function Oe(i){var e=new MutationObserver(()=>{fe(i,i.__value)});e.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Pe(()=>{e.disconnect()})}function ce(i){return"__value"in i?i.__value:i.value}function te(i,e,t=e){var a=new WeakSet;xe(i,"input",async s=>{var l=s?i.defaultValue:i.value;if(l=ae(i)?re(l):l,t(l),X!==null&&a.add(X),await Fe(),l!==(l=e())){var P=i.selectionStart,j=i.selectionEnd,h=i.value.length;if(i.value=l??"",j!==null){var b=i.value.length;P===j&&j===h&&b>h?(i.selectionStart=b,i.selectionEnd=b):(i.selectionStart=P,i.selectionEnd=Math.min(j,b))}}}),($&&i.defaultValue!==i.value||Se(e)==null&&i.value)&&(t(ae(i)?re(i.value):i.value),X!==null&&a.add(X)),Le(()=>{var s=e();if(i===document.activeElement){var l=Ie??X;if(a.has(l))return}ae(i)&&s===re(i.value)||i.type==="date"&&!s&&!i.value||s!==i.value&&(i.value=s??"")})}function ae(i){var e=i.type;return e==="number"||e==="range"}function re(i){return i===""?null:+i}class Qe{#e;get all(){return r(this.#e)}set all(e){L(this.#e,e,!0)}#t;get isLoading(){return r(this.#t)}set isLoading(e){L(this.#t,e,!0)}#a;get isFormOpen(){return r(this.#a)}set isFormOpen(e){L(this.#a,e,!0)}#r;get filterStatus(){return r(this.#r)}set filterStatus(e){L(this.#r,e,!0)}#i;get filterQuery(){return r(this.#i)}set filterQuery(e){L(this.#i,e,!0)}#s;get filterProject(){return r(this.#s)}set filterProject(e){L(this.#s,e,!0)}constructor(){this.#e=E(J([])),this.#t=E(!1),this.#a=E(!1),this.#r=E("all"),this.#i=E(""),this.#s=E("all")}get filtered(){let e=this.all.slice();if(this.filterStatus!=="all"&&(e=e.filter(t=>this.filterStatus==="active"?t.status==="active":t.status==="done")),this.filterProject&&this.filterProject!=="all"&&(e=e.filter(t=>(t.project||"")===this.filterProject)),this.filterQuery&&this.filterQuery.trim()!==""){const t=this.filterQuery.toLowerCase();e=e.filter(a=>(a.title||"").toLowerCase().includes(t)||(a.prompt||"").toLowerCase().includes(t)||(a.topic||"").toLowerCase().includes(t)||(a.project||"").toLowerCase().includes(t))}return e}get activeCards(){return this.all.filter(e=>e.status==="active")}get completedCards(){return this.all.filter(e=>e.status==="done")}get cardCount(){return this.all.length}async loadCards(){if(!(typeof window>"u"||!("api"in window))){this.isLoading=!0;try{const t=(await window.api.getCards()).map(a=>({...a,createdAt:new Date(a.createdAt)})).sort((a,s)=>s.createdAt.getTime()-a.createdAt.getTime());this.all=t}catch(e){console.error("Failed to load cards:",e)}finally{this.isLoading=!1}}}async addCard(e){if(!(typeof window>"u"||!("api"in window)))try{const t=await window.api.addCard(e);return this.all=[t,...this.all],t}catch(t){throw console.error("Failed to add card:",t),t}}async updateCard(e){if(!(typeof window>"u"||!("api"in window)))try{const t=await window.api.updateCard(e),a=this.all.findIndex(s=>s.id===e.id);return a!==-1&&(this.all[a]=t),t}catch(t){throw console.error("Failed to update card:",t),t}}async deleteCard(e){if(!(typeof window>"u"||!("api"in window)))try{await window.api.deleteCard(e),this.all=this.all.filter(t=>t.id!==e)}catch(t){throw console.error("Failed to delete card:",t),t}}async updateCardStatus(e,t){if(!(typeof window>"u"||!("api"in window)))try{await window.api.toggleCard(e,t);const a=this.all.findIndex(s=>s.id===e);a!==-1&&(this.all[a]={...this.all[a],status:t})}catch(a){throw console.error("Failed to update card status:",a),a}}async runPrompt(e){if(!(typeof window>"u"||!("api"in window)))try{await window.api.runPrompt(e)}catch(t){throw console.error("Failed to run prompt:",t),t}}async runPromptWithSystem(e,t){if(typeof window>"u"||!("api"in window))return;let a=e;t?.trim()&&(a=`${t.trim()}

${e}`);try{await window.api.runPrompt(a)}catch(s){throw console.error("Failed to run prompt:",s),s}}toggleForm(){this.isFormOpen=!this.isFormOpen}openForm(){this.isFormOpen=!0}closeForm(){this.isFormOpen=!1}setFilterStatus(e){this.filterStatus=e}setFilterQuery(e){this.filterQuery=e}setFilterProject(e){this.filterProject=e}}const z=new Qe;class Ne{#e;get all(){return r(this.#e)}set all(e){L(this.#e,e,!0)}#t;get isLoading(){return r(this.#t)}set isLoading(e){L(this.#t,e,!0)}#a;get viewMode(){return r(this.#a)}set viewMode(e){L(this.#a,e,!0)}#r;get selectedProjectId(){return r(this.#r)}set selectedProjectId(e){L(this.#r,e,!0)}constructor(){this.#e=E(J([])),this.#t=E(!1),this.#a=E("list"),this.#r=E(null)}get selectedProject(){return this.viewMode==="list"?"all":this.viewMode==="create"?"create":this.selectedProjectId||"all"}async loadProjects(){if(typeof window>"u"||!("api"in window)){console.warn("Window API not available, skipping project load");return}this.isLoading=!0;try{const e=await window.api.getProjects();Array.isArray(e)&&(this.all=e.slice().sort((t,a)=>t.name.localeCompare(a.name)))}catch(e){console.error("Failed to load projects from main process",e)}finally{this.isLoading=!1}}async createProject(e,t){const a=e.trim();if(!a)throw new Error("Project name is required");if(typeof window>"u"||!("api"in window))throw new Error("Window API not available - preload may not have loaded");const s=await window.api.createProject({name:a,systemPrompt:t});return this.all=[...this.all,s].sort((l,P)=>l.name.localeCompare(P.name)),s}selectAll(){this.viewMode="list",this.selectedProjectId=null,z.setFilterProject("all")}selectProject(e){if(e===null||e==="all"){this.selectAll();return}if(e==="create"){this.viewMode="create",this.selectedProjectId=null,z.setFilterProject("all");return}this.viewMode="detail",this.selectedProjectId=e,z.setFilterProject(e)}selectCreateProject(){this.viewMode="create",this.selectedProjectId=null,z.setFilterProject("all")}async updateProject(e){if(!e.id||!e.name.trim())throw new Error("Project ID and name are required");if(typeof window>"u"||!("api"in window))throw new Error("Window API not available");const t=await window.api.updateProject(e),a=this.all.findIndex(s=>s.id===e.id);return a!==-1&&(this.all[a]=t,this.all.sort((s,l)=>s.name.localeCompare(l.name))),t}async deleteProject(e){if(!e)throw new Error("Project ID is required");if(typeof window>"u"||!("api"in window))throw new Error("Window API not available");await window.api.deleteProject(e),this.all=this.all.filter(t=>t.id!==e),this.selectedProjectId===e&&this.selectAll()}findById(e){return this.all.find(t=>t.id===e)}}const p=new Ne;var We=y('<p id="name-error" class="field-error svelte-t06kqd" role="alert"> </p>'),Be=y('<p id="system-prompt-error" class="field-error svelte-t06kqd" role="alert"> </p>'),Ve=y('<p class="submission-error svelte-t06kqd" role="alert"></p>'),Ge=y('<section class="project-create svelte-t06kqd"><h2 class="svelte-t06kqd">Create project</h2> <form class="project-form svelte-t06kqd"><label for="proj-name" class="svelte-t06kqd">Project name</label> <input id="proj-name" type="text" placeholder="e.g. JavaScript"/> <!> <p class="hint svelte-t06kqd" id="project-hint">The project name appears in the sidebar list.</p> <label for="proj-system-prompt" class="svelte-t06kqd">System prompt <span class="optional">(optional)</span></label> <textarea id="proj-system-prompt" placeholder="e.g. You are an expert JavaScript developer. Always provide code examples and explain best practices." rows="4"></textarea> <!> <p class="hint svelte-t06kqd" id="system-prompt-hint">This prompt will be prepended to all learning cards in this project when sent to ChatGPT.</p> <!> <div class="actions svelte-t06kqd"><button type="submit" class="primary svelte-t06kqd"> </button> <button type="button" class="ghost svelte-t06kqd">Cancel</button></div></form></section>');function Ye(i,e){K(e,!0);let t=E(J({name:"",systemPrompt:""})),a=E(!1),s=E(J({}));const l=se(()=>r(s).name?"name-error project-hint":"project-hint");var P=Ge(),j=v(n(P),2),h=v(n(j),2);me(h);let b;var I=v(h,2);{var q=m=>{var w=We(),T=n(w,!0);d(w),N(()=>W(T,r(s).name)),f(m,w)};O(I,m=>{r(s).name&&m(q)})}var F=v(I,6);ve(F);let g;var D=v(F,2);{var o=m=>{var w=Be(),T=n(w,!0);d(w),N(()=>W(T,r(s).systemPrompt)),f(m,w)};O(D,m=>{r(s).systemPrompt&&m(o)})}var c=v(D,4);{var x=m=>{var w=Ve();w.textContent=submissionError,f(m,w)};O(c,m=>{submissionError&&m(x)})}var M=v(c,2),_=n(M),C=n(_,!0);d(_);var S=v(_,2);S.__click=cancel,d(M),d(j),d(P),N(()=>{R(j,"aria-describedby",r(l)),R(h,"aria-invalid",r(s).name?"true":"false"),h.disabled=r(a),b=ee(h,1,"svelte-t06kqd",null,b,{error:r(s).name}),R(F,"aria-invalid",r(s).systemPrompt?"true":"false"),F.disabled=r(a),g=ee(F,1,"",null,g,{error:r(s).systemPrompt}),_.disabled=r(a),W(C,r(a)?"Creating...":"Create project"),S.disabled=r(a)}),ue("submit",j,handleSubmit),te(h,()=>r(t).name,m=>r(t).name=m),te(F,()=>r(t).systemPrompt,m=>r(t).systemPrompt=m),f(i,P),H()}V(["click"]);V(["change","click"]);var ze=y('<dialog open class="modal-overlay"><div class="modal-content" aria-labelledby="edit-heading" role="document"><!></div></dialog>'),Je=y('<section class="project-detail svelte-1ykxz3w"><header><h2></h2> <div class="actions svelte-1ykxz3w"><button class="primary" type="button">+ New Learning Item</button></div></header> <!> <!></section>');function Ke(i,e){K(e,!0),B(()=>{(!p.all||p.all.length===0)&&p.loadProjects()});var t=Je(),a=n(t),s=n(a);s.textContent=project?project.name:"Project";var l=v(s,2),P=n(l);P.__click=openAddForm,d(l),d(a);var j=v(a,2);{var h=I=>{var q=ze();q.__click=D=>{D.target===D.currentTarget&&handleEditCancel()},q.__keydown=D=>D.key==="Escape"&&handleEditCancel();var F=n(q),g=n(F);EditCardForm(g,{card:editingCard,onSubmit:handleEditSubmit,onCancel:handleEditCancel}),d(F),d(q),f(I,q)};O(j,I=>{editingCard&&I(h)})}var b=v(j,2);CardList(b,{onStart:handleStart,onToggle:handleCardToggle,onEdit:handleCardEdit,onDelete:handleCardDelete}),d(t),f(i,t),H()}V(["click","keydown"]);var He=y('<div role="alert" class="form-status error"> </div>'),Xe=y('<span class="error-message"> </span>'),Ze=y('<span class="hint">Pick a clear name so you can find this project fast.</span>'),Re=y('<span class="error-message"> </span>'),Ue=y('<span class="hint">This text will auto-prepend to every card prompt in the project—great for tone, context, or guardrails. Max 500 characters.</span>'),$e=y('<section id="edit-project-section"><form aria-labelledby="edit-project-heading"><h2 id="edit-project-heading">Edit Project</h2> <!> <div class="field"><label for="edit-project-name">Project name <span class="required">*</span></label> <input id="edit-project-name" type="text" autocomplete="off" required/> <!></div> <div class="field"><label for="edit-project-system-prompt">System prompt <span class="optional">(optional)</span></label> <textarea id="edit-project-system-prompt" placeholder="Add context or constraints that should prefix every card prompt for this project." rows="6"></textarea> <!></div> <div class="form-actions"><button type="submit" class="primary"> </button> <button type="button" class="ghost">Cancel</button></div></form></section>');function et(i,e){K(e,!0);let t=E(J({name:"",systemPrompt:""}));const a=J({name:"",systemPrompt:""});let s=E(""),l=E(!1);B(()=>{L(t,{name:e.project.name,systemPrompt:e.project.systemPrompt||""},!0)}),B(()=>{const u=r(t).name.trim();u.length===0?a.name="Project name is required":u.length>50?a.name="Project name must be less than 50 characters":a.name=""}),B(()=>{r(t).systemPrompt.trim().length>8e3?a.systemPrompt="System prompt must be less than 8000 characters":a.systemPrompt=""});const P=se(()=>!a.name&&!a.systemPrompt&&r(t).name.trim().length>0);let j=E(null);B(()=>{const u=document.getElementById("edit-project-name");u&&setTimeout(()=>u.focus(),0);const k=Q=>{Q.key==="Escape"&&e.onCancel()};return window.addEventListener("keydown",k),()=>{window.removeEventListener("keydown",k)}});var h=$e(),b=n(h),I=v(n(b),2);{var q=u=>{var k=He(),Q=n(k,!0);d(k),N(()=>W(Q,r(s))),f(u,k)};O(I,u=>{r(s)&&u(q)})}var F=v(I,2),g=v(n(F),2);me(g);let D;var o=v(g,2);{var c=u=>{var k=Xe(),Q=n(k,!0);d(k),N(()=>W(Q,a.name)),f(u,k)},x=u=>{var k=Ze();f(u,k)};O(o,u=>{a.name?u(c):u(x,!1)})}d(F);var M=v(F,2),_=v(n(M),2);ve(_);let C;var S=v(_,2);{var m=u=>{var k=Re(),Q=n(k,!0);d(k),N(()=>W(Q,a.systemPrompt)),f(u,k)},w=u=>{var k=Ue();f(u,k)};O(S,u=>{a.systemPrompt?u(m):u(w,!1)})}d(M);var T=v(M,2),A=n(T),G=n(A,!0);d(A);var Y=v(A,2);Y.__click=function(...u){e.onCancel?.apply(this,u)},d(T),d(b),d(h),ie(h,u=>L(j,u),()=>r(j)),N(()=>{g.disabled=r(l),D=ee(g,1,"",null,D,{error:a.name}),_.disabled=r(l),C=ee(_,1,"",null,C,{error:a.systemPrompt}),A.disabled=!r(P)||r(l),W(G,r(l)?"Saving...":"Save changes"),Y.disabled=r(l)}),ue("submit",b,handleSubmit),te(g,()=>r(t).name,u=>r(t).name=u),te(_,()=>r(t).systemPrompt,u=>r(t).systemPrompt=u),f(i,h),H()}V(["click"]);var tt=y('<details class="more-menu svelte-rmjvfi"><summary class="more-trigger svelte-rmjvfi"><span aria-hidden="true">⋮</span></summary> <div class="menu svelte-rmjvfi" role="menu"><button type="button" role="menuitem" class="svelte-rmjvfi">Edit</button> <button type="button" role="menuitem" class="danger svelte-rmjvfi">Delete</button></div></details>');function at(i,e){K(e,!0);const t=De();let a=E("");B(()=>{L(a,e.ariaLabel??"",!0)});let s=E(null),l=E(null);function P(){t("edit"),r(s)&&(r(s).open=!1)}function j(){t("delete"),r(s)&&(r(s).open=!1)}B(()=>{r(s)?.open&&requestAnimationFrame(()=>{r(l)?.querySelector("button")?.focus()})});var h=tt(),b=n(h);b.__keydown=g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),r(s)&&(r(s).open=!r(s).open))};var I=v(b,2),q=n(I);q.__click=P;var F=v(q,2);F.__click=j,d(I),ie(I,g=>L(l,g),()=>r(l)),d(h),ie(h,g=>L(s,g),()=>r(s)),N(()=>R(b,"aria-label",r(a))),f(i,h),H()}V(["keydown","click"]);var rt=y('<li class="empty svelte-138d5ja">No projects yet — create one.</li>'),it=y('<li><div class="project-card-wrapper svelte-138d5ja"><button class="project-card svelte-138d5ja"><span class="project-name svelte-138d5ja"> </span></button> <div class="project-actions svelte-138d5ja"><!></div></div></li>'),st=y('<dialog open class="modal-overlay"><div class="modal-content" aria-labelledby="edit-project-heading" role="document"><!></div></dialog>'),ot=y('<section class="projects svelte-138d5ja"><header><h2>Projects</h2> <div class="actions svelte-138d5ja"><p class="hint">Create a project from the header above.</p></div></header> <ul class="project-list svelte-138d5ja"><!></ul> <!></section>');function lt(i,e){K(e,!0);function t(o){p.selectProject(o),e.onopen?.({projectId:o})}let a=E(null);function s(o){const c=p.all.find(x=>x.id===o);c&&L(a,c,!0)}async function l(o){const c=p.all.find(x=>x.id===o);window.confirm(`Are you sure you want to delete the project "${c?.name}"?

This will unassign all cards from this project.`)&&await p.deleteProject(o)}async function P(o){await p.updateProject(o),L(a,null)}function j(){L(a,null)}var h=ot(),b=v(n(h),2),I=n(b);{var q=o=>{var c=rt();f(o,c)},F=o=>{var c=U(),x=Z(c);pe(x,17,()=>p.all,M=>M.id,(M,_)=>{var C=it(),S=n(C),m=n(S);m.__click=()=>t(r(_).id);var w=n(m),T=n(w,!0);d(w),d(m);var A=v(m,2),G=n(A);{let Y=se(()=>`More actions for project ${r(_).name}`);at(G,{get ariaLabel(){return r(Y)},$$events:{edit:()=>s(r(_).id),delete:()=>l(r(_).id)}})}d(A),d(S),d(C),N(()=>{R(m,"aria-label",`Open project ${r(_).name}`),W(T,r(_).name)}),f(M,C)}),f(o,c)};O(I,o=>{p.all.length===0?o(q):o(F,!1)})}d(b);var g=v(b,2);{var D=o=>{var c=st();c.__click=_=>{_.target===_.currentTarget&&j()},c.__keydown=_=>_.key==="Escape"&&j();var x=n(c),M=n(x);et(M,{get project(){return r(a)},onSubmit:P,onCancel:j}),d(x),d(c),f(o,c)};O(g,o=>{r(a)&&o(D)})}d(h),f(i,h),H()}V(["click","keydown"]);var nt=y('<meta name="description" content="Finish what you start"/>'),dt=y('<button class="primary" aria-label="Create project">+ New Project</button>'),ct=y('<button class="ghost" aria-label="Back to projects">← Projects</button>'),ut=y("<option> </option>"),vt=y('<div class="project-controls svelte-1uha8ag"><label class="project-filter svelte-1uha8ag">Project: <select aria-label="Switch project" class="svelte-1uha8ag"><option>All projects</option><!></select></label> <button class="ghost" aria-label="Back to projects">← Projects</button></div>'),mt=y("<p>Loading...</p>"),pt=y('<div id="sr-announcements" class="sr-only" aria-live="polite" aria-atomic="true"></div> <div class="container"><header><h1>Learning Space</h1> <p class="subtitle">Finish what you start</p> <div class="top-actions"><!></div></header> <main id="main-content"><!></main></div>',1);function bt(i,e){K(e,!0),qe(()=>{(async()=>await Promise.all([z.loadCards(),p.loadProjects()]))()});function t(o){const c=o.project;p.selectProject(c)}function a(o){const x=o.target.value;x==="all"?p.selectAll():x&&p.selectProject(x)}var s=pt();Te("1uha8ag",o=>{var c=nt();Me(()=>{Ae.title="Learning Space"}),f(o,c)});var l=v(Z(s),2),P=n(l),j=v(n(P),4),h=n(j);{var b=o=>{var c=dt();c.__click=()=>p.selectCreateProject(),f(o,c)},I=o=>{var c=U(),x=Z(c);{var M=C=>{var S=ct();S.__click=()=>p.selectProject("all"),f(C,S)},_=C=>{var S=vt(),m=n(S),w=v(n(m));w.__change=a;var T=n(w);T.value=T.__value="all";var A=v(T);pe(A,17,()=>p.all,u=>u.id,(u,k)=>{var Q=ut(),he=n(Q,!0);d(Q);var oe={};N(()=>{W(he,r(k).name),oe!==(oe=r(k).id)&&(Q.value=(Q.__value=r(k).id)??"")}),f(u,Q)}),d(w);var G;Oe(w),d(m);var Y=v(m,2);Y.__click=()=>p.selectProject("all"),d(S),N(()=>{G!==(G=p.selectedProject)&&(w.value=(w.__value=p.selectedProject)??"",fe(w,p.selectedProject))}),f(C,S)};O(x,C=>{p.selectedProject==="create"?C(M):C(_,!1)},!0)}f(o,c)};O(h,o=>{p.selectedProject==="all"?o(b):o(I,!1)})}d(j),d(P);var q=v(P,2),F=n(q);{var g=o=>{var c=mt();f(o,c)},D=o=>{var c=U(),x=Z(c);{var M=C=>{lt(C,{onopen:S=>p.selectProject(S.projectId)})},_=C=>{var S=U(),m=Z(S);{var w=A=>{Ye(A,{oncreated:t})},T=A=>{Ke(A,{get projectId(){return p.selectedProject}})};O(m,A=>{p.selectedProject==="create"?A(w):A(T,!1)},!0)}f(C,S)};O(x,C=>{p.selectedProject==="all"?C(M):C(_,!1)},!0)}f(o,c)};O(F,o=>{z.isLoading||p.isLoading?o(g):o(D,!1)})}d(q),d(l),f(i,s),H()}V(["click","change"]);export{bt as component};
